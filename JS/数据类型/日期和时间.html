<script>
    //--- 创建Date ----------------------------------------------------
    // let now = new Date();
    // alert(now);

    // let Jan01_1970 = new Date(0);
    // alert(Jan01_1970);

    // let Jan02_1970 = new Date(24 * 3600 * 1000);
    // alert(Jan02_1970);

    // let Dec31_1969 = new Date(-24 * 3600 * 1000);
    // alert(Dec31_1969);

    // let date = new Date('2017-01-26');
    // alert(date);

    // let date = new Date();

    // alert(date.getHours());

    // alert( date.getUTCHours() );


    //--- 度量 Benchmark ----------------------------------------------------
    // function diffSubtract(date1, date2) {
    //     return date2 - date1;
    // }

    // function diffGetTime(date1, date2) {
    //     return date2.getTime() - date1.getTime();
    // }

    // function bench(func) {
    //     let date1 = new Date(0);
    //     let date2 = new Date();

    //     let start = Date.now();
    //     for (let i = 0; i < 100000; i++) {
    //         func(date1, date2);
    //     }
    //     return Date.now() - start;
    // }

    // 可能 第一个函数比第二个函数缺少CPU资源（当时有CPU在并行处理其他事务
    // alert( 'Time of diffSubtract: ' + bench(diffSubtract) + 'ms' );
    // alert( 'Time of diffGetTime: ' + bench(diffGetTime) + 'ms');


    // 为了更加可靠的数据，多次运行
    // let time1 = 0;
    // let time2 = 0;

    // bench(diffSubtract);
    // bench(diffGetTime);

    // for (let i = 0; i < 10; i++) {
    //     time1 += bench(diffSubtract);
    //     time2 += bench(diffGetTime);
    // }

    // alert('Total time for diffSubtract: ' + time1 + 'ms');
    // alert('Total time for diffGetTime: ' + time2 + 'ms');


    //--- 创建日期 ------------------------------------------
    // let newDate = new Date(2012, 1, 20, 3, 12);
    // alert( newDate );

    // let newDate2 = new Date("February 20, 2012 03:12:00");
    // alert( newDate2 );


    //--- 显示星期数 -------------------------------------------------
    // let date = new Date(2014, 0, 3);
    // alert(getWeekDay(date));

    // function getWeekDay() {
    //     let days = ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'];

    //     return days[date.getDay()];
    // }


    //--- 显示欧洲的星期表示方式 -------------------------------------------------
    // let date = new Date(2012, 0, 3);  // 3 Jan 2012
    // alert(getLocalDay(date));       // 星期二，应该显示 2

    // function getLocalDay(date) {
    //     let day = date.getDay();
    //     if (day == 0) {
    //         day == 7;
    //     }

    //     return day;
    // }


    //--- 许多天之前是哪个月几号？ ------------------------------------------------
    // let date = new Date(2015, 0, 2);

    // alert(getDateAgo(date, 1)); // 1, (1 Jan 2015)
    // alert(getDateAgo(date, 2)); // 31, (31 Dec 2014)
    // alert(getDateAgo(date, 365)); // 2, (2 Jan 2014)

    // 解法 1：
    // function getDateAgo(date, days) {
    //     date.setDate(date.getDate() - days);
    //     return date.getDate();
    // }

    // 解法 2：
    // function getDateAgo(date, days) {
    //     let dateCopy = new Date(date);

    //     dateCopy.setDate(date.getDate() - days);
    //     return dateCopy.getDate();
    // }


    //--- 某月的最后一天 --------------------------------------------------
    // function getLastDayOfMonth(year, month) {
    //     let date = new Date(year, month + 1, 0);
    //     return date.getDate();
    // }

    // alert(getLastDayOfMonth(2012, 0));
    // alert(getLastDayOfMonth(2012, 1));
    // alert(getLastDayOfMonth(2012, 2));


    //--- 今天过去了多少秒 -----------------------------------------------------
    // 解法 1：
    // function getSecondsToday() {
    //     let now = new Date();

    //     let today = new Date(now.getFullYear(), now.getMonth(), now.getDate());

    //     let diff = now - today;
    //     return Math.round(diff/1000);
    // }


    // 解法 2：
    // function getSecondsToday() {
    //     let now = new Date();

    //     return now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
    // };

    // alert(getSecondsToday());


    //--- 距离明天还有多少秒 --------------------------------------------
    // 解法 1：
    // function getSecondsToTomorrow() {
    //     let now = new Date();
    //     return (24 - now.getHours() - 1) * 3600
    //         + (60 - now.getMinutes() - 1) * 60
    //         + (60 - now.getSeconds());
    // }

    // alert(getSecondsToTomorrow());


    // 解法 2：
    // function getSecondsToTomorrow() {
    //     let now = new Date();
    //     // alert(now);
    //     let tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);

    //     let diff = tomorrow - now;
    //     return Math.round(diff / 1000);
    // }

    // alert(getSecondsToTomorrow());


    // 解法 3：
    // function getSecondsToTomorrow() {
    //     let now = new Date();
    //     let hour = now.getHours();
    //     let minutes = now.getMinutes();
    //     let seconds = now.getSeconds();
    //     let totalSecondsToday = (hour * 60 + minutes) * 60 + seconds;
    //     let totalSecondsInADay = 86400;

    //     return totalSecondsInADay - totalSecondsToday;
    // }

    // alert(getSecondsToTomorrow());


    //--- 格式化相对日期 ----------------------------------------------
    // 解法 1：
    // function formatDate(date) {
    //     let now = new Date();
    //     if (now - date < 1000) {
    //         return 'right now';
    //     } else if (now - date < 60 * 1000) {
    //         return `${(now - date) / 1000} sec. ago`;
    //     } else if (now - date < 60 * 60 * 1000) {
    //         return `${(now - date) / 60000} min. ago`;
    //     } else {
    //         let d = date;
    //         d = [
    //             '0' + d.getDate(),
    //             '0' + (d.getMonth() + 1),
    //             '' + d.getFullYear(),
    //             '0' + d.getHours(),
    //             '0' + d.getMinutes()
    //         ].map(component => component.slice(-2));

    //         alert(date);
    //         return d.slice(0, 3).join('.') + ' ' + d.slice(3).join(':');
    //     }
    // }


    // alert(formatDate(new Date(new Date - 1))); // "right now"

    // alert(formatDate(new Date(new Date - 30 * 1000))); // "30 sec. ago"

    // alert(formatDate(new Date(new Date - 5 * 60 * 1000))); // "5 min. ago"

    // // 昨天的日期如：31.12.2016 20:00
    // alert(formatDate(new Date(new Date - 86400 * 1000)));

    // 解法 2：
    function formatDate(date) {
        let dayOfMonth = date.getDate();
        let month = date.getMonth() + 1;
        let year = date.getFullYear();
        let hour = date.getHours();
        let minutes = date.getMinutes();
        let diffMs = new Date() - date;
        let diffSec = Math.round(diffMs / 1000);
        let diffMin = diffSec / 60;
        let diffHour = diffMin / 60;

        year = year.toString().slice(-2);
        month = month < 10 ? '0' + month : month;
        dayOfMonth = dayOfMonth < 10 ? '0' + dayOfMonth : dayOfMonth;
        hour = hour < 10 ? '0' + hour : hour;
        minutes = minutes < 10 ? '0' + minutes : minutes;

        if (diffSec < 1) {
            return 'right now';
        } else if (diffMin < 1) {
            return `${diffSec} sec.ago`
        } else if (diffHour < 1) {
            return `${diffMin} min. ago`
        } else {
            return `${dayOfMonth}.${month}.${year} ${hour}:${minutes}`
        }
    }

    alert(formatDate(new Date(new Date - 1))); // "right now"

    alert(formatDate(new Date(new Date - 30 * 1000))); // "30 sec. ago"

    alert(formatDate(new Date(new Date - 5 * 60 * 1000))); // "5 min. ago"

    // 昨天的日期如：31.12.2016 20:00
    alert(formatDate(new Date(new Date - 86400 * 1000)));

</script>